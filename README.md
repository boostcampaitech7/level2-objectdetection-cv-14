# ğŸ“‹ Project Overview


![project_image](https://github.com/user-attachments/assets/a15ac710-0ed3-496b-9e86-00213727cde5)

ë°”ì•¼íë¡œ ëŒ€ëŸ‰ ìƒì‚°, ëŒ€ëŸ‰ ì†Œë¹„ì˜ ì‹œëŒ€. ìš°ë¦¬ëŠ” ë§ì€ ë¬¼ê±´ì´ ëŒ€ëŸ‰ìœ¼ë¡œ ìƒì‚°ë˜ê³ , ì†Œë¹„ë˜ëŠ” ì‹œëŒ€ë¥¼ ì‚´ê³  ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ëŸ¬í•œ ë¬¸í™”ëŠ” 'ì“°ë ˆê¸° ëŒ€ë€', 'ë§¤ë¦½ì§€ ë¶€ì¡±'ê³¼ ê°™ì€ ì—¬ëŸ¬ ì‚¬íšŒ ë¬¸ì œë¥¼ ë‚³ê³  ìˆìŠµë‹ˆë‹¤.

ë¶„ë¦¬ìˆ˜ê±°ëŠ” ì´ëŸ¬í•œ í™˜ê²½ ë¶€ë‹´ì„ ì¤„ì¼ ìˆ˜ ìˆëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ì˜ ë¶„ë¦¬ë°°ì¶œ ëœ ì“°ë ˆê¸°ëŠ” ìì›ìœ¼ë¡œì„œ ê°€ì¹˜ë¥¼ ì¸ì •ë°›ì•„ ì¬í™œìš©ë˜ì§€ë§Œ, ì˜ëª» ë¶„ë¦¬ë°°ì¶œ ë˜ë©´ ê·¸ëŒ€ë¡œ íê¸°ë¬¼ë¡œ ë¶„ë¥˜ë˜ì–´ ë§¤ë¦½ ë˜ëŠ” ì†Œê°ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ì‚¬ì§„ì—ì„œ ì“°ë ˆê¸°ë¥¼ Detection í•˜ëŠ” ëª¨ë¸ì„ ë§Œë“¤ì–´ ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²°í•´ë³´ê³ ì í•©ë‹ˆë‹¤.

- ì…ë ¥
  - **ì“°ë ˆê¸° ê°ì²´ê°€ ë‹´ê¸´ ì´ë¯¸ì§€, bbox ì •ë³´(ì¢Œí‘œ, ì¹´í…Œê³ ë¦¬)**
  - bbox annotationì€ **COCO format**
- ì¶œë ¥
  - **bbox ì¢Œí‘œ, ì¹´í…Œê³ ë¦¬, score** ê°’ì„ ë¦¬í„´.
  - submission ì–‘ì‹ì— ë§ê²Œ csv íŒŒì¼ì„ ë§Œë“¤ì–´ ì œì¶œ
  - COCO formatì´ ì•„ë‹Œ **Pascal VOC format**

<br/>

# ğŸ—ƒï¸ Dataset

- ì „ì²´ ì´ë¯¸ì§€
  - **9754 images**
  - train
    - **4883 images**
  - test
    - **4871 images**
- í´ë˜ìŠ¤ ìˆ˜
  - **10 class**
  - General trash, Paper, Paper pack, Metal, Glass, Plastic, Styrofoam, Plastic bag, Battery, Clothing
- ì´ë¯¸ì§€ í¬ê¸°
  - **1024 x 1024**

<br/>

# ğŸ˜„ Team Member

<table align="center">
    <tr align="center">
        <td><img src="https://github.com/user-attachments/assets/3560856a-8cac-4079-8494-4f1bf13d0eb5" width="140"></td>
        <td><img src="https://github.com/user-attachments/assets/3560856a-8cac-4079-8494-4f1bf13d0eb5" width="140"></td>
        <td><img src="https://github.com/user-attachments/assets/3560856a-8cac-4079-8494-4f1bf13d0eb5" width="140"></td>
        <td><img src="https://github.com/user-attachments/assets/3560856a-8cac-4079-8494-4f1bf13d0eb5" width="140"></td>
        <td><img src="https://github.com/user-attachments/assets/fdce3bf1-4dd2-44c9-b4db-1599c4d3826d" width="140" height="140"></td>
        <td><img src="https://github.com/user-attachments/assets/3560856a-8cac-4079-8494-4f1bf13d0eb5" width="140"></td>
    </tr>
    <tr align="center">
        <td><a href="https://github.com/kimgeonsu" target="_blank">ê¹€ê±´ìˆ˜</a></td>
        <td><a href="https://github.com/202250274" target="_blank">ë°•ì§„ì˜</a></td>
        <td><a href="https://github.com/oweixx" target="_blank">ë°©ë¯¼í˜</a></td>
        <td><a href="https://github.com/lkl4502" target="_blank">ì˜¤í™ì„</a></td>
        <td><a href="https://github.com/Soy17" target="_blank">ì´ì†Œì˜</a></td>
        <td><a href="https://github.com/yejin-s9" target="_blank">ì´ì˜ˆì§„</a></td>
    </tr>
    <tr align="center">
        <td>T7103</td>
        <td>T7156</td>
        <td>T7158</td>
        <td>T7208</td>
        <td>T7222</td>
        <td>T7225</td>
    </tr>
</table>

<br/>

# ğŸ—‚ï¸ Role

| Member |                                            Role                                            |
| :----: | :----------------------------------------------------------------------------------------: |
| ê¹€ê±´ìˆ˜ |                            PM ì—­í•  ìˆ˜í–‰, YOLO Develop, Ensemble                            |
| ë°•ì§„ì˜ |                         ConvNeXT Develop, Ensemble, Util ê¸°ëŠ¥ êµ¬í˜„                         |
| ë°©ë¯¼í˜ |                       EDA, Data Relabel, ATSS Swin Develop, Ensemble                       |
| ì˜¤í™ì„ | PM ì—­í•  ìˆ˜í–‰, DETR ê¸°ë°˜ Model Develop, <br> Util ê¸°ëŠ¥ êµ¬í˜„, Project êµ¬ì¡° ë° ì„œë²„ í™˜ê²½ êµ¬ì„± |
| ì´ì†Œì˜ |                        VFNet, RTMDet Model Develop, Util ê¸°ëŠ¥ êµ¬í˜„                         |
| ì´ì˜ˆì§„ |                          EDA, Data Relabel, Pseudo Labeling, TTA                           |

<br/>

# ğŸ§³ Project Progress Summary

ì•„ë˜ì˜ í•­ëª©ë“¤ë¡œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•œ ê³¼ì •ì„ ì„¤ëª…í•œë‹¤.

<br>

## Project Structure

```
ğŸ“¦ level2-objectdetection-cv-14
â”£ ğŸ“‚ EDA_data
â”ƒ â”£ ğŸ“œ eda_(2).ipynb
â”ƒ â”£ ğŸ“œ eda_dataset.ipynb
â”ƒ â”£ ğŸ“œ eda_traindata.ipynb
â”£ ğŸ“‚ mmdetection
â”ƒ â”£ ğŸ“‚ configs
â”ƒ â”£ ğŸ“‚ custom_configs
â”ƒ â”£ ğŸ“‚ mmdet
â”ƒ â”— ğŸ“œ train.py
â”ƒ â”— ğŸ“œ inference.py
â”£ ğŸ“‚ mmdetectionV3
â”ƒ â”£ ğŸ“‚ configs
â”ƒ â”£ ğŸ“‚ custom_configs
â”ƒ â”£ ğŸ“‚ mmdet
â”ƒ â”— ğŸ“œ train.py
â”ƒ â”— ğŸ“œ inference.py
â”£ ğŸ“‚ yolo
â”£ ğŸ“‚ utils
â”ƒ â”£ ğŸ“œ csv_pseudo.py
â”ƒ â”£ ğŸ“œ Ensemble.py
â”ƒ â”£ ğŸ“œ Gsheet.py
â”ƒ â”£ ğŸ“œ modify_test.py
â”ƒ â”£ ğŸ“œ pseudo_data_split.py
â”ƒ â”£ ğŸ“œ pseudo_ensemble_labeling.py
â”ƒ â”£ ğŸ“œ pseudo_labeling.py
â”ƒ â”£ ğŸ“œ pseudo_labes_count.py
â”ƒ â”£ ğŸ“œ split_val_train_log.py
â”ƒ â”£ ğŸ“œ Stratified_Group_K_Fold.py
â”£ ğŸ“ƒ requirements.txt
â”— ğŸ“ƒ README.md
```

<br>

## ğŸ•µğŸ» EDA

Class Imbalance, Object Size ë“± ì—¬ëŸ¬ í•­ëª©ì— ëŒ€í•´ì„œ ì§„í–‰í•˜ì˜€ë‹¤.  
ì•„ë˜ëŠ” ê·¸ ì¤‘ í•˜ë‚˜ì— ëŒ€í•œ ì˜ˆì‹œì´ë‹¤.  
[Wrap-UP Report ì°¸ê³ ](#-object-detection-wrap-up-report)

> ### BBox Area Distribution

![image](https://github.com/user-attachments/assets/17fbdea6-f2e2-4ee6-acca-45ea9a0cb2d3)

- Clothingì€ ìƒëŒ€ì ìœ¼ë¡œ í° ë°•ìŠ¤ í¬ê¸°ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©° Batteryì™€ ê°™ì€ ë¬¼ì²´ëŠ” ì‘ê³  ì¼ì •í•œ í¬ê¸°ë¡œ ë‚˜íƒ€ë‚˜ëŠ” ê²½í–¥ì„ í™•ì¸
- Glass, Plastic, Paper Pack, Plastic bag ë“±ì˜ ê²½ìš°, ë°•ìŠ¤ í¬ê¸°ê°€ ë§¤ìš° ë‹¤ì–‘í•œ ë¶„í¬ë¥¼ ë³´ì„

<br>

## ğŸ§ª Experiments

ì§„í–‰í•œ ì‹¤í—˜ìœ¼ë¡œëŠ” Data Relabeling, Pseudo Labeling ë“±ì´ ìˆë‹¤.  
ì•„ë˜ëŠ” ê·¸ ì¤‘ í•˜ë‚˜ì— ëŒ€í•œ ì˜ˆì‹œì´ë‹¤.  
[Wrap-UP Report ì°¸ê³ ](#-object-detection-wrap-up-report)

> ### Data Relabeling

<img src="https://github.com/user-attachments/assets/44948f78-f7f2-4215-af5f-b3d47e67d9e4" height="300">  
<img src="https://github.com/user-attachments/assets/5e0ed86d-04d7-4631-854f-e52b8b78d73e" height="300">

- ì˜ëª»ëœ ë¼ë²¨ë§ì— ëŒ€í•´ì„œ ìˆ˜ì •í•˜ëŠ” ì‘ì—…ì„ ê±°ì¹¨
- Object ë§ˆë‹¤ labelì˜ í†µì¼ì„± ìœ ì§€ ex) ì „ë‹¨ì§€ë‚˜ ëª…í•¨ ê°™ì€ ê²½ìš° General trashë¡œ í†µì¼

<br>

## ğŸ“š Model Selection and Develop

ì‚¬ìš©í•œ ëª¨ë¸ì—ëŠ” ATSS Swin, ConvNeXT, DINO ë“±ë“± ì—¬ëŸ¬ê°€ì§€ê°€ ìˆë‹¤.  
ì•„ë˜ëŠ” ê·¸ ì¤‘ í•˜ë‚˜ì— ëŒ€í•œ ì˜ˆì‹œì´ë‹¤.  
[Wrap-UP Report ì°¸ê³ ](#-object-detection-wrap-up-report)

> ### ATSS Swin

| Version |                  Description                   | Public mAP 50 |
| :-----: | :--------------------------------------------: | :-----------: |
|    1    |           ATSS Swin Base model ì ìš©            |    0.5587     |
|    2    |  pretrained model êµì²´ (swin win12-384 model)  |    0.5397     |
|    3    |          Cascade Swin Base model ì ìš©          |    0.5482     |
|    4    |       load_from(ì‚¬ì „ í•™ìŠµëœ ê°€ì¤‘ì¹˜) ì ìš©       |    0.6297     |
|    5    |               Anchor ratios ìˆ˜ì •               |    0.6073     |
|    6    | train_pipelineì˜ Resizeë¥¼ multiscale_v1ë¡œ ìˆ˜ì • |    0.6536     |
|    7    |               Hard Augmentation                |       0       |
|    8    |  train_pipelineì˜ Resizeë¥¼ (1024,1024)ë¡œ ìˆ˜ì •  |    0.6558     |
|    9    | train_pipelineì˜ Resizeë¥¼ multiscale_v2ë¡œ ìˆ˜ì • |    0.6800     |

<br>

## ğŸ–‡ï¸ Ensemble

- ëª¨ë¸ê°„ ì•™ìƒë¸”ì—ì„œ 2ê°€ì§€ ì „ëµì„ ì‚¬ìš©í•˜ì˜€ë‹¤.
- Stratified Group K Fold Cross Validation
  - ê°ê¸° ë‹¤ë¥¸ Foldì— í•™ìŠµí•œ ê°™ì€ êµ¬ì¡°ì˜ ëª¨ë¸ê°„ ì•™ìƒë¸” (NMS, WBF)
- ë‹¤ë¥¸ ëª¨ë¸ê°„ ì•™ìƒë¸”
  - Confusion Matrixì™€ ê°™ì€ í‰ê°€ ì§€í‘œë¥¼ í™œìš©í•˜ì—¬ ëª¨ë¸ê°„ íŠ¹ì„±ì„ íŒŒì•…
  - íŒŒì•…í•œ ëª¨ë¸ê°„ íŠ¹ì„±ì„ ë°”íƒ•ìœ¼ë¡œ ìµœì ì˜ ëª¨ë¸ ì¡°í•© ì„ íƒ

> ### Stratified Group K Fold Cross Validation Ensemble

|   Model   | Fold Avg Score |  WBF   |  NMS   |
| :-------: | :------------: | :----: | :----: |
| ConvNeXT  |     0.6929     | 0.7091 | 0.7063 |
|   DINO    |     0.6969     | 0.5328 | 0.7106 |
| ATSS Swin |     0.6791     | 0.6929 | 0.6970 |
|   YOLO    |     0.4360     | 0.5539 | 0.5272 |
|  CO-DINO  |     0.6955     | 0.6212 | 0.7111 |

<br>

> ### Final Model Ensemble Strategy

![image](https://github.com/user-attachments/assets/6e1b4d3f-deed-4f10-8c53-c48d61d69164)

<br>

## Utils

í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ í¸ì˜ì„±ì„ ìœ„í•œ ê¸°ëŠ¥ ë˜ëŠ” ì‹¤í—˜ì„ ìœ„í•œ ì¶”ê°€ ê¸°ëŠ¥ë“¤ì„ êµ¬í˜„í•˜ì˜€ë‹¤.

- Stratified Group K Fold Cross Validation
- Google Sheetì„ ì´ìš©í•œ ì‹¤í—˜ ì¸ì ê¸°ë¡ ìë™í™”
- Pseudo Labeling ê´€ë ¨ ê¸°ëŠ¥
- train / inference log ë¶„í•  ê¸°ëŠ¥ ë“±ë“±

ì•„ë˜ëŠ” ê·¸ ì¤‘ í•˜ë‚˜ì— ëŒ€í•œ ì˜ˆì‹œì´ë‹¤.  
[Notion ì°¸ê³ ](#-object-detection-notion)

> ### Stratified Group K Fold Cross Validation
>
> - í•™ìŠµí•œ ëª¨ë¸ì˜ ì„±ëŠ¥ í‰ê°€ë¥¼ ìœ„í•´ì„œ Validation Setì„ ë¶„ë¦¬í•´ë‚¸ë‹¤.
> - ê¸°ì¡´ ë°ì´í„° ì…‹ì˜ í´ë˜ìŠ¤ ë¶„í¬ë¥¼ ìœ ì§€í•œë‹¤. (ì•„ë˜ í‘œ ì°¸ê³ )
> - ê°™ì€ ì´ë¯¸ì§€ì—ì„œ ë‚˜ì˜¨ annotationì´ Train ë˜ëŠ” Validationì—ë§Œ í¬í•¨ë˜ë„ë¡ êµ¬ë¶„í•œë‹¤.

<table align="center">
  <thead align="center">
    <tr>
      <th></th>
      <th>General trash</th>
      <th>Paper</th>
      <th>Paper pack</th>
      <th>Metal</th>
      <th>Glass</th>
      <th>Plastic</th>
      <th>Styrofoam</th>
      <th>Plastic bag</th>
      <th>Battery</th>
      <th>Clothing</th>
    </tr>
  </thead>
  <tbody align="center">
    <tr>
      <th nowrap>training set</th>
      <td>17.14%</td>
      <td>27.45%</td>
      <td>3.88%</td>
      <td>4.04%</td>
      <td>4.24%</td>
      <td>12.72%</td>
      <td>5.46%</td>
      <td>22.37%</td>
      <td>0.69%</td>
      <td>2.02%</td>
    </tr>
    <tr>
      <th nowrap>train - fold1</th>
      <td>17.11%</td>
      <td>26.73%</td>
      <td>3.92%</td>
      <td>4.07%</td>
      <td>4.14%</td>
      <td>13.01%</td>
      <td>5.46%</td>
      <td>22.88%</td>
      <td>0.66%</td>
      <td>2.02%</td>
    </tr>
    <tr>
      <th>val - fold1</th>
      <td>17.23%</td>
      <td>29.88%</td>
      <td>3.72%</td>
      <td>3.96%</td>
      <td>4.59%</td>
      <td>11.70%</td>
      <td>5.45%</td>
      <td>20.66%</td>
      <td>0.76%</td>
      <td>2.04%</td>
    </tr>
    <tr>
      <th nowrap>train - fold2</th>
      <td>17.17%</td>
      <td>27.75%</td>
      <td>3.92%</td>
      <td>4.16%</td>
      <td>4.27%</td>
      <td>12.52%</td>
      <td>5.47%</td>
      <td>22.21%</td>
      <td>0.66%</td>
      <td>1.88%</td>
    </tr>
    <tr>
      <th>val - fold2</th>
      <td>17.01%</td>
      <td>26.23%</td>
      <td>3.72%</td>
      <td>3.58%</td>
      <td>4.13%</td>
      <td>13.53%</td>
      <td>5.40%</td>
      <td>23.02%</td>
      <td>0.81%</td>
      <td>2.58%</td>
    </tr>
    <tr>
      <th nowrap>train - fold3</th>
      <td>17.05%</td>
      <td>27.66%</td>
      <td>3.95%</td>
      <td>3.81%</td>
      <td>4.37%</td>
      <td>12.35%</td>
      <td>5.67%</td>
      <td>22.51%</td>
      <td>0.66%</td>
      <td>1.99%</td>
    </tr>
    <tr>
      <th>val - fold3</th>
      <td>17.53%</td>
      <td>26.55%</td>
      <td>3.56%</td>
      <td>5.04%</td>
      <td>3.71%</td>
      <td>14.29%</td>
      <td>4.56%</td>
      <td>21.79%</td>
      <td>0.82%</td>
      <td>2.16%</td>
    </tr>
    <tr>
      <th nowrap>train - fold4</th>
      <td>17.18%</td>
      <td>27.19%</td>
      <td>3.85%</td>
      <td>4.00%</td>
      <td>4.28%</td>
      <td>12.66%</td>
      <td>5.66%</td>
      <td>22.37%</td>
      <td>0.70%</td>
      <td>2.11%</td>
    </tr>
    <tr>
      <th>val - fold4</th>
      <td>16.96%</td>
      <td>28.54%</td>
      <td>4.00%</td>
      <td>4.23%</td>
      <td>4.07%</td>
      <td>12.94%</td>
      <td>4.59%</td>
      <td>22.40%</td>
      <td>0.64%</td>
      <td>1.64%</td>
    </tr>
    <tr>
      <th nowrap>train - fold5</th>
      <td>17.18%</td>
      <td>27.88%</td>
      <td>3.75%</td>
      <td>4.19%</td>
      <td>4.15%</td>
      <td>13.05%</td>
      <td>5.02%</td>
      <td>21.92%</td>
      <td>0.76%</td>
      <td>2.11%</td>
    </tr>
    <tr>
      <th>val - fold5</th>
      <td>16.95%</td>
      <td>25.66%</td>
      <td>4.41%</td>
      <td>3.46%</td>
      <td>4.63%</td>
      <td>11.33%</td>
      <td>7.23%</td>
      <td>24.25%</td>
      <td>0.40%</td>
      <td>1.68%</td>
    </tr>
  </tbody>
</table>

<br>

## ğŸ† Project Result

**_<p align=center>Public Leader Board</p>_**
<img src="https://github.com/user-attachments/assets/659d0f34-f546-4a6f-9939-d254bcb98a15" alt="Public Leader Board" >

<br>

**_<p align=center>Private Leader Board</p>_**
<img src="https://github.com/user-attachments/assets/d870f505-96db-4dee-bd16-ab9e03f7ba66" alt="Private Leader Board" >

<br>

## ğŸ”— Reference

### [ğŸ“ Object Detection Wrap-UP Report](https://drive.google.com/file/d/1MvqASckPwXHHoGqNLIGiQHgjQBBYPDgK/view?usp=sharing)

### [ğŸ“ Object Detection Notion](https://violet-join-36b.notion.site/Recycle-Object-Detection-f114581f9bae41faba6cd302474f02d5?pvs=4)

<br>

## Commit Convention

1. `Feature` : **ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€**
2. `Fix` : **ë²„ê·¸ ìˆ˜ì •**
3. `Docs` : **ë¬¸ì„œ ìˆ˜ì •**
4. `Style` : **ì½”ë“œ í¬ë§·íŒ… â†’ Code Convention**
5. `Refactor` : **ì½”ë“œ ë¦¬íŒ©í† ë§**
6. `Test` : **í…ŒìŠ¤íŠ¸ ì½”ë“œ**
7. `Comment` : **ì£¼ì„ ì¶”ê°€ ë° ìˆ˜ì •**

ì»¤ë°‹í•  ë•Œ í—¤ë”ì— ìœ„ ë‚´ìš©ì„ ì‘ì„±í•˜ê³  ì „ë°˜ì ì¸ ë‚´ìš©ì„ ê°„ë‹¨í•˜ê²Œ ì‘ì„±í•©ë‹ˆë‹¤.

### ì˜ˆì‹œ

- `git commit -m "[#issue] Feature : message content"`

ì»¤ë°‹í•  ë•Œ ìƒì„¸ ë‚´ìš©ì„ ì‘ì„±í•´ì•¼ í•œë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì§„í–‰í•©ë‹ˆë‹¤.

### ì˜ˆì‹œ

> `git commit`  
> ì–´ë– í•œ ì—ë””í„°ë¡œ ì§„ì…í•˜ê²Œ ëœ í›„ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•©ë‹ˆë‹¤.  
> `[header]: ì „ë°˜ì ì¸ ë‚´ìš©`  
> . **(í•œ ì¤„ ë¹„ì›Œì•¼ í•¨)**  
> ìƒì„¸ ë‚´ìš©

<br/>

## Branch Naming Convention

ë¸Œëœì¹˜ë¥¼ ìƒˆë¡­ê²Œ ë§Œë“¤ ë•Œ, ë¸Œëœì¹˜ ì´ë¦„ì€ í•­ìƒ ìœ„ `Commit Convention`ì˜ Headerì™€ í•¨ê»˜ ì‘ì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

### ì˜ˆì‹œ

- `Feature/~~~`
- `Refactor/~~~`
